任务一状态机的实现，下面几个点需要特别理清
1. RSM 是单独的一层中间件
   位置：它夹在“上层应用程序”（如 KV Server）和“底层共识”（Raft）之间。
   作用：
   向下：它负责处理与 Raft 复杂的交互（调用 Start，监听 applyCh，处理快照）。
   向上：它给应用程序提供极其简单的接口 Submit(command)。应用程序不需要关心 Raft 的 Term、Index、心跳等细节，只需要告诉 RSM：“我要执行这个命令”，然后等结果。

2. 机器数目与 Raft 强绑定（1对1）
   物理部署：通常我们将“KV 服务 + RSM 代码 + Raft 代码”编译在同一个二进制程序里运行。
   数量一致：如果有 5 台物理服务器，那么就有：
   5 个 KV 服务实例
   5 个 RSM 实例
   5 个 Raft 实例
   它们在同一个进程的内存空间内，通过函数调用（Function Call）和 Go Channel 交互。

3. 状态机的 Leader 就是 Raft 的 Leader
   应用程序（状态机）本身通常是无状态或对等的。但是，因为只有 Raft 的 Leader 才能成功调用 Start() 处理写请求，所以只有运行在 Raft Leader 节点上的那个应用程序实例，才能真正作为服务   的 Leader 接收客户端请求。
   如果一个节点的 Raft 是 Follower，调用 RSM.Submit -> Raft.Start 会立刻失败（返回 ErrWrongLeader），迫使客户端去寻找真正的 Leader。

4. 状态机之间的交互全靠 Raft 消息
   无直接通信：Server 1 的状态机绝对不会直接发 TCP/RPC 给 Server 2 的状态机说“把 x 加 1”。
   日志即真理：
   Server 1（Leader）收到请求，通过 Raft 达成共识。
   Raft 将操作写入日志，并复制给 Server 2, 3, 4, 5。
   Server 2 的 Raft 通知 Server 2 的 RSM：“收到一个新日志（x+1）”。
   Server 2 的 RSM 执行该逻辑。
   通过这种方式，所有节点虽然不直接对话，但只要按相同的顺序执行 Raft 传过来的相同的日志，大家的状态（内存里的数据）就永远保持一致。

下面是示意图
+-------------------------------------------------------+
|  Client (Clerk)                                       |
+---------------------------+---------------------------+
                            | RPC (Put/Get)
                            v
+-------------------------------------------------------+
|  [Server 节点 (比如 server.go)]                        |
|                                                       |
|  1. 应用程序 (StateMachine)                            |
|     - 实现 DoOp() 真正干活 (比如 map[key]=value)        |
|     - 调用 rsm.Submit() 发送请求                       |
|                                                       |
|  +-------------------------------------------------+  |
|  | 2. RSM 层 (rsm.go)                                 |
|  |    - Submit(): 封装 Op, 调 Raft, 等待结果           |
|  |    - Loop: 读 applyCh, 调 DoOp(), 通知 Submit       |
|  +------------------------+------------------------+  |
|                           |                           |
|  +------------------------v------------------------+  |
|  | 3. Raft 层 (raft.go)                               |
|  |    - Start(), applyCh                              |
|  +-------------------------------------------------+  |
+-------------------------------------------------------+